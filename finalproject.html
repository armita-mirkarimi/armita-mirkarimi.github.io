<!DOCTYPE html>
<html>
<head>
  <title>Mapping Iran's Contemporary Protests</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
  ></script>
  
  <style>
    .map-container {
      height: 800px; 
      width: 500px;
      margin-bottom: 50px; 
    }
    html, body {
      height: 100%;
      margin: 2px;
      padding: 2px;
    }
     table {
      width: 80%;
      margin: 0 auto;
      border-collapse: collapse;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 10px;
      text-align: center;
    }
  </style>
</head>
<body>
  
  <!-- This is my title -->
  <h1 style="color: #FFFFFF;
            background: #FFFFFF;
            text-shadow: 2px 2px 0 #4074b5, 2px -2px 0 #4074b5, -2px 2px 0 #4074b5, -2px -2px 0 #4074b5, 2px 0px 0 #4074b5, 0px 2px 0 #4074b5, -2px 0px 0 #4074b5, 0px -2px 0 #4074b5;
            color: #FFFFFF;
            background: #FFFFFF;">
  <img src="womeniran.jpg" style="height: 100px; width: 100%;"> 
    <center>Mapping Iran's Contemporary Protests</center>
  </h1>

  <!-- This is my subtitle -->
  <h2 style="font: georgia;">
    Since the 1979 Islamic Revolution, Iran has been riddled with bursts of protest with various causes and flashpoints.
    From the closure of reformist newspapers and election integrity to economic price hikes, Iran's protests in the modern day 
    are essential features in understanding life under the Islamic Republic. On this page, I walk through the following protests 
    in recent Iranian history: 
    <ol style="font: georgia; color: #800000;">
      <li>The 1999 Student Protests</li>
      <li>The 2009 Green Movement</li>
      <li>The 2017-18 Economic Protests</li>
      <li>2019 Price Hike Protests</li>
    </ol>
    The map on this page will show the geography of these protests: Where they are dispersed in the country and the number of deaths,
    detainments, and participants. 
  </h2>

  <!-- This is my second title --> 

  <h1 style="color: #FFFFFF;
            background: #B30000;
            color: #FFFFFF;
            background: #B30000;">
    
    Let's start with the population of Iran.
    
  </h1>

  <!-- This is my first map -->
  <div class="map-container" id="map"></div>

  <script>
    function symbology(feature) {
      var population = feature.properties.POPULATION;
      var lineColor = "red";

      return {
        color: lineColor,
        weight: 3,
        opacity: 0.5
      };
    }

    $(document).ready(function () {
      var map = L.map("map").setView([32.4279, 53.6880], 5);

      var tile = L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png", {
        maxZoom: 19,
        attribution: 'Courtesy of Humanitarian Data Exchange'
      }).addTo(map);

      // Create population layer 
      var population = L.layerGroup().addTo(map);

      var response = $.ajax({
        url: "Iran_Population.geojson",
        dataType: "json",
        success: function (data) {
          var populationLayer = L.geoJson(data, {
            color: "#002800",
            weight: 3,
            opacity: 0.5,
            onEachFeature: function (feature, layer) {
              layer.bindPopup("<b>Population: " + feature.properties.POPULATION + "</b>")
            }
          }).addTo(population); 
        },
        error: function (xhr) {
          alert(xhr.statusText);
        }
      });

      var all = $.when(response);

      all.done(function () {
      });
    });
  </script>


  <h1 style="color: #FFFFFF;
            background: #B30000;
            color: #FFFFFF;
            background: #B30000;">

Let's now examine the protests regionally.
    
  </h1>

  <!-- This is my second map -->
  <div class="map-container" id="map1"></div>

  <script>
    $(document).ready(function () {
      var map1 = L.map("map1").setView([32.4279, 53.6880], 5);

      var tile1 = L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png", {
        maxZoom: 19,
        attribution: 'Courtesy of Humanitarian Data Exchange'
      }).addTo(map1);

      // Create a layer group for the second map
      var protest = L.layerGroup().addTo(map1);

      var response1 = $.ajax({
        url: "Protest_data2.geojson",
        dataType: "json",
        success: function (data) {
          var protestLayer = L.geoJson(data, {
            style: symbology,
            onEachFeature: function (feature, layer) {
              layer.bindPopup("<b>Deaths: " + feature.properties.DEATHS + "</b>");
            }
          }).addTo(protest); 
        },
        error: function (xhr) {
          alert(xhr.statusText);
        }
      });

      var all = $.when(response1);

      all.done(function () {
      });
    });
  </script>

 <h2 style="color: #FFFFFF;
            background: #B30000;
            color: #FFFFFF;
            background: #B30000;">

What do these points all mean? 
    
  </h2>

  <table>
    <tr>
        <th style="font-size: 22px; color: #B30000;" colspan="4">Contemporary Protests in a Snapshot</th>
  
    </tr>
    <tr>
        <th style="font-size: 18px;">Protest Name</th>
        <th style="font-size: 18px;">Deaths</th>
        <th style="font-size: 18px;">Detained</th>
        <th style="font-size: 18px;">Participants</th>
    </tr>
    <tr>
        <td>The 1999 Student Protests</td>
        <td>4</td>
        <td>14,000</td>
        <td>10,000</td>
    </tr>
    
    <tr>
      <td>The 2009 Green Movement</td>
      <td>100</td>
      <td>4,000</td>
      <td>3,000,000</td>
    </tr>

    <tr>
      <td>The 2017-18 Economic Protests</td>
      <td>22</td>
      <td>3,700</td>
      <td>42,000</td>
    </tr>

    <tr>
      <td>2019 Price Hike Protests</td>
      <td>304</td>
      <td>7,000</td>
      <td>200,000</td>
    </tr>

    <tr>
      <td>January 2020 Protests</td>
      <td>Unknown</td>
      <td>30</td>
      <td>4,000</td>
    </tr>
  </table>

  <h2 style="color: #FFFFFF;
            background: #B30000;
            color: #FFFFFF;
            background: #B30000;">

Let's overlay the maps together! 
    
  </h2>

<!-- This is my third map with both layers and a styled button -->
<div class="map-container" id="map2">
  <button id="toggleButton" style="position: absolute; top: 10px; left: 10px; z-index: 1000;">Click to see protest data</button>
</div>

<script>
 $(document).ready(function () {
  // Create the third map and its layers
  var map2 = L.map("map2").setView([32.4279, 53.6880], 5);

  var tile2 = L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png", {
    maxZoom: 19,
    attribution: 'Courtesy of Humanitarian Data Exchange'
  }).addTo(map2);

  var populationLayer2 = L.layerGroup().addTo(map2);
  var protestLayer2 = L.layerGroup().addTo(map2);

  var response2 = $.ajax({
    url: "Iran_Population.geojson",
    dataType: "json",
    success: function (data) {
      L.geoJson(data, {
        color: "#002800",
        weight: 3,
        opacity: 0.5,
        onEachFeature: function (feature, layer) {
          layer.bindPopup("<b>Population: " + feature.properties.POPULATION + "</b>");
        }
      }).addTo(populationLayer2);
    },
    error: function (xhr) {
      alert(xhr.statusText);
    }
  });

  var response3 = $.ajax({
    url: "Protest_data2.geojson",
    dataType: "json",
    success: function (data) {
      L.geoJson(data, {
        style: symbology, // Use the existing symbology function
        onEachFeature: function (feature, layer) {
          layer.bindPopup("<b>Deaths: " + feature.properties.DEATHS + "</b>");
        }
      }).addTo(protestLayer2);
    },
    error: function (xhr) {
      alert(xhr.statusText);
    }
  });

  var all = $.when(response2, response3);

  all.done(function () {
    // Your code when both requests are completed
  });

  // Add a click event handler for the button
  $("#toggleButton").click(function () {
    // Toggle the visibility of the protest layer
    if (map2.hasLayer(protestLayer2)) {
      map2.removeLayer(protestLayer2);
    } else {
      map2.addLayer(protestLayer2);
    }
  });
});
</script>

</body>
</html>
